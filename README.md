## Prototype Development for Image Captioning Using the BLIP Model and Gradio Framework

### AIM:
To design and deploy a prototype application for image captioning by utilizing the BLIP image-captioning model and integrating it with the Gradio UI framework for user interaction and evaluation.

### PROBLEM STATEMENT:
Create a Python application that automatically generates captions for images. The system should allow users to upload an image, convert it to a format suitable for sending to a Hugging Face Image-to-Text API, and receive a meaningful caption generated by the model. The application should also provide a user-friendly web interface built using Gradio, where users can upload images and view the generated captions.
### DESIGN STEPS:

### STEP 1:
Import necessary libraries such as requests, PIL, base64, and Gradio.Load environment variables to access the Hugging Face API key and endpoint URL.
### STEP 2:
Write a function to send image data to the Hugging Face Image-to-Text API (get_completion).Convert uploaded image to Base64 string so it can be sent in the API request.
### STEP 3:
Create a captioning function (captioner) that takes a PIL image, converts it to Base64, sends it to the API, and returns the caption.Build a Gradio interface that includes an image upload input and a text output box.
### STEP 4:
Add example images for easy testing inside the Gradio UI.Launch the Gradio app, making it accessible to the user.
### PROGRAM:

```
import os
import io
import IPython.display
from PIL import Image
import base64 
from dotenv import load_dotenv, find_dotenv
_ = load_dotenv(find_dotenv()) # read local .env file
hf_api_key = os.environ['HF_API_KEY']
# Helper functions
import requests, json

#Image-to-text endpoint
def get_completion(inputs, parameters=None, ENDPOINT_URL=os.environ['HF_API_ITT_BASE']):
    headers = {
      "Authorization": f"Bearer {hf_api_key}",
      "Content-Type": "application/json"
    }
    data = { "inputs": inputs }
    if parameters is not None:
        data.update({"parameters": parameters})
    response = requests.request("POST",
                                ENDPOINT_URL,
                                headers=headers,
                                data=json.dumps(data))
    return json.loads(response.content.decode("utf-8"))
image_url = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRt8dOSGViDBCSO5dOYGSAeDfD30Wt06RsAkQ&s"
display(IPython.display.Image(url=image_url))
get_completion(image_url)
import gradio as gr 

def image_to_base64_str(pil_image):
    byte_arr = io.BytesIO()
    pil_image.save(byte_arr, format='PNG')
    byte_arr = byte_arr.getvalue()
    return str(base64.b64encode(byte_arr).decode('utf-8'))

def captioner(image):
    base64_image = image_to_base64_str(image)
    result = get_completion(base64_image)
    return result[0]['generated_text']

gr.close_all()
demo = gr.Interface(fn=captioner,
                    inputs=[gr.Image(label="Upload image", type="pil")],
                    outputs=[gr.Textbox(label="Caption")],
                    title="Image Captioning with BLIP",
                    description="Caption any image using the BLIP model",
                    allow_flagging="never",
                    examples=["nature.jpg", "animal.jpeg", "building.webp"])

demo.launch(share=True, server_port=int(os.environ['PORT1']))
```

### OUTPUT:

<img width="1192" height="419" alt="image" src="https://github.com/user-attachments/assets/d6aedd9c-7844-4595-b754-795849027a81" />

<img width="1199" height="632" alt="image" src="https://github.com/user-attachments/assets/98daca06-87c3-4759-a74e-17810a06807a" />


### RESULT:
Thus the program to design and deploy a prototype application for image captioning was executed successfully.

